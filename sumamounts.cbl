        IDENTIFICATION DIVISION.
        PROGRAM-ID. SUMAM.
        AUTHOR. Francesco Lazzarotto.
        INSTALLATION. OK. 
        DATE-WRITTEN. 06/01/2026. 
        DATE-COMPILED. 06/01/2026. 
        SECURITY. free.
      * THIS CREATE AN INPUT FILE FOR PROGRAM EX01 .
        ENVIRONMENT DIVISION. 
        CONFIGURATION SECTION. 
        SOURCE-COMPUTER. Lenovo Linux. 
        OBJECT-COMPUTER. Lenovo Linux.
        INPUT-OUTPUT SECTION. 
        FILE-CONTROL.
          SELECT IN-FILE ASSIGN "OUT03.dat".
        DATA DIVISION.
        FILE SECTION.
		FD IN-FILE.
		01 IN-TOTALS.
			03 IN-MONTH-TOT PIC 9(8)V99 OCCURS 12.
		WORKING-STORAGE SECTION.
		01 WS-MONTH PIC 99 VALUE 01.
		01 RE-REC PIC 9(3) VALUE 00.
		01 TOT-AMOUNT PIC 9(10)V99 VALUE 0.0.
        PROCEDURE DIVISION.
		AA-START.
		  OPEN INPUT IN-FILE.
		  INITIALISE IN-TOTALS.
		BB-READ.
		  READ IN-FILE AT END GO TO ZZ-END.
		  ADD 1 TO RE-REC.
		  PERFORM CC-PROCESS 12 TIMES.
		  GO TO BB-READ.
		CC-PROCESS.
		  DISPLAY "MONTH " 
		  WS-MONTH " AMOUNT " 
		  IN-MONTH-TOT(WS-MONTH).
		  ADD IN-MONTH-TOT(WS-MONTH) TO TOT-AMOUNT.
		  ADD 1 TO WS-MONTH.
	    ZZ-END.
		  DISPLAY "TOT-AMOUNT = " TOT-AMOUNT.
	      DISPLAY RE-REC " RECORDS READ".
		  DISPLAY "PROGRAM ENDED: EXITING".
          CLOSE IN-FILE.
		  STOP RUN.
